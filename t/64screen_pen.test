local vt=init()
local screen = wantscreen(vt, "")

reset(state,screen)

-- Plain
push "A"
  ?screen_cell 0,0 = {41} width=1 attrs={} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- Bold
push "\x1b[1mB"
  ?screen_cell 0,1 = {42} width=1 attrs={B} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- Italic
push "\x1b[3mC"
  ?screen_cell 0,2 = {43} width=1 attrs={BI} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- Underline
push "\x1b[4mD"
  ?screen_cell 0,3 = {44} width=1 attrs={BU1I} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- Reset
push "\x1b[mE"
  ?screen_cell 0,4 = {45} width=1 attrs={} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- Font
push "\x1b[11mF\x1b[m"
  ?screen_cell 0,5 = {46} width=1 attrs={F1} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- Foreground
push "\x1b[31mG\x1b[m"
  ?screen_cell 0,6 = {47} width=1 attrs={} fg=rgb(224,0,0) bg=rgb(0,0,0)

-- Background
push "\x1b[42mH\x1b[m"
  ?screen_cell 0,7 = {48} width=1 attrs={} fg=rgb(240,240,240) bg=rgb(0,224,0)

-- Super/subscript
push "x\x1b[74m0\x1b[73m2\x1b[m"
  ?screen_cell 0,8  = {78} width=1 attrs={} fg=rgb(240,240,240) bg=rgb(0,0,0)
  ?screen_cell 0,9  = {30} width=1 attrs={S_} fg=rgb(240,240,240) bg=rgb(0,0,0)
  ?screen_cell 0,10 = {32} width=1 attrs={S^} fg=rgb(240,240,240) bg=rgb(0,0,0)

-- EL sets only colours to end of line, not other attrs
push "\x1b[H\x1b[7;33;44m\x1b[K"
  ?screen_cell 0,0  = {} width=1 attrs={} fg=rgb(224,224,0) bg=rgb(0,0,224)
  ?screen_cell 0,79 = {} width=1 attrs={} fg=rgb(224,224,0) bg=rgb(0,0,224)

-- DECSCNM xors reverse for entire screen
push "R\x1b[?5h"
  ?screen_cell 0,0  = {52} width=1 attrs={} fg=rgb(224,224,0) bg=rgb(0,0,224)
  ?screen_cell 1,0  = {} width=1 attrs={R} fg=rgb(240,240,240) bg=rgb(0,0,0)
push "\x1b[?5\$p"
  output "\x1b[?5;1\$y"
push "\x1b[?5l"
  ?screen_cell 0,0  = {52} width=1 attrs={R} fg=rgb(224,224,0) bg=rgb(0,0,224)
  ?screen_cell 1,0  = {} width=1 attrs={} fg=rgb(240,240,240) bg=rgb(0,0,0)
push "\x1b[?5\$p"
  output "\x1b[?5;2\$y"

-- Set default colours
reset(state,screen)
push "ABC\x1b[31mDEF\x1b[m"
  ?screen_cell 0,0  = {41} width=1 attrs={} fg=rgb(240,240,240) bg=rgb(0,0,0)
  ?screen_cell 0,3  = {44} width=1 attrs={} fg=rgb(224,0,0) bg=rgb(0,0,0)
SETDEFAULTCOL rgb(252,253,254)
  ?screen_cell 0,0  = {41} width=1 attrs={} fg=rgb(252,253,254) bg=rgb(0,0,0)
  ?screen_cell 0,3  = {44} width=1 attrs={} fg=rgb(224,0,0) bg=rgb(0,0,0)
SETDEFAULTCOL rgb(250,250,250) rgb(10,20,30)
  ?screen_cell 0,0  = {41} width=1 attrs={} fg=rgb(250,250,250) bg=rgb(10,20,30)
  ?screen_cell 0,3  = {44} width=1 attrs={} fg=rgb(224,0,0) bg=rgb(10,20,30)
