local vt=init()
vterm.vterm_set_utf8(vt, true)
local state = wantstate(vt, "g")m

-- 79th Column
push "\x1b[75G"
push "A"x5
  putglyph 41 1 0,74
  putglyph 41 1 0,75
  putglyph 41 1 0,76
  putglyph 41 1 0,77
  putglyph 41 1 0,78
  ?cursor = 0,79

-- 80th Column Phantom
push "A"
  putglyph 41 1 0,79
  ?cursor = 0,79

-- Line Wraparound
push "B"
  putglyph 42 1 1,0
  ?cursor = 1,1

-- Line Wraparound during combined write
push "\x1b[78G"
push "BBBCC"
  putglyph 42 1 1,77
  putglyph 42 1 1,78
  putglyph 42 1 1,79
  putglyph 43 1 2,0
  putglyph 43 1 2,1
  ?cursor = 2,2

-- DEC Auto Wrap Mode
reset(state,screen)
push "\x1b[?7l"
push "\x1b[75G"
push "D"x6
  putglyph 44 1 0,74
  putglyph 44 1 0,75
  putglyph 44 1 0,76
  putglyph 44 1 0,77
  putglyph 44 1 0,78
  putglyph 44 1 0,79
  ?cursor = 0,79
push "D"
  putglyph 44 1 0,79
  ?cursor = 0,79
push "\x1b[?7h"

-- 80th column causes linefeed on wraparound
push "\x1b[25;78HABC"
  putglyph 41 1 24,77
  putglyph 42 1 24,78
  putglyph 43 1 24,79
  ?cursor = 24,79
push "D"
  moverect 1..25,0..80 -> 0..24,0..80
  putglyph 44 1 24,0

-- 80th column phantom linefeed phantom cancelled by explicit cursor move
push "\x1b[25;78HABC"
  putglyph 41 1 24,77
  putglyph 42 1 24,78
  putglyph 43 1 24,79
  ?cursor = 24,79
push "\x1b[25;1HD"
  putglyph 44 1 24,0
